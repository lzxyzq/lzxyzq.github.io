<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>从Excel到Python——数据分析 | Dandy Yue</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="摘要Excel是数据分析中最常用的工具，本系列文章摘自蓝鲸老师的新书以及自己的一些扩充，该书通过Python与Excel的功能对比介绍如何使用Python通过函数式编程完成Excel中的数据处理及分析工作。在Python中pandas库用于数据处理，从1787页的pandas官网文档中总结出最常用的36个函数，通过这些函数介绍如何通过Python完成数据生成和导入、数据清洗、预处理，以及最常见的数">
<meta name="keywords" content="数据分析">
<meta property="og:type" content="article">
<meta property="og:title" content="从Excel到Python——数据分析">
<meta property="og:url" content="http://github.com/lzxyzq/2018/06/02/从Excel到Python——数据分析/index.html">
<meta property="og:site_name" content="Dandy Yue">
<meta property="og:description" content="摘要Excel是数据分析中最常用的工具，本系列文章摘自蓝鲸老师的新书以及自己的一些扩充，该书通过Python与Excel的功能对比介绍如何使用Python通过函数式编程完成Excel中的数据处理及分析工作。在Python中pandas库用于数据处理，从1787页的pandas官网文档中总结出最常用的36个函数，通过这些函数介绍如何通过Python完成数据生成和导入、数据清洗、预处理，以及最常见的数">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-07-02T13:40:49.126Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="从Excel到Python——数据分析">
<meta name="twitter:description" content="摘要Excel是数据分析中最常用的工具，本系列文章摘自蓝鲸老师的新书以及自己的一些扩充，该书通过Python与Excel的功能对比介绍如何使用Python通过函数式编程完成Excel中的数据处理及分析工作。在Python中pandas库用于数据处理，从1787页的pandas官网文档中总结出最常用的36个函数，通过这些函数介绍如何通过Python完成数据生成和导入、数据清洗、预处理，以及最常见的数">
  
    <link rel="alternative" href="/atom.xml" title="Dandy Yue" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: true
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate">Yue Dandy</a></h1>
        </hgroup>

        
        <p class="header-subtitle">Sense and Simplicity</p>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="search" placeholder=" Search...">
            </form>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/Home">博客首页</a></li>
                        
                            <li><a href="/About">作品展示</a></li>
                        
                            <li><a href="https://www.zhihu.com/pub/">静心阅读</a></li>
                        
                            <li><a href="https://www.vmovier.com/53766">光影之路</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/Machine-Learning/" style="font-size: 10px;">Machine Learning</a> <a href="/tags/R语言/" style="font-size: 10px;">R语言</a> <a href="/tags/函数/" style="font-size: 10px;">函数</a> <a href="/tags/分类/" style="font-size: 10px;">分类</a> <a href="/tags/回归/" style="font-size: 10px;">回归</a> <a href="/tags/数据分析/" style="font-size: 20px;">数据分析</a> <a href="/tags/数据可视化/" style="font-size: 10px;">数据可视化</a> <a href="/tags/数据挖掘/" style="font-size: 10px;">数据挖掘</a> <a href="/tags/文件/" style="font-size: 10px;">文件</a> <a href="/tags/计算机系统/" style="font-size: 10px;">计算机系统</a> <a href="/tags/计算机网络/" style="font-size: 10px;">计算机网络</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://github.com/lzxyzq/">Github</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://mp.weixin.qq.com/s?__biz=MzI4MzAxNDQ1Mw==&mid=207493606&idx=3&sn=a85753ccfc195c50a0e509ff0add0850#rd">公众号</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">侦探🕵️迷、爱交友、爱旅行、喜欢接触新鲜事物、迎接新的挑战，更爱游离于错综复杂的编码与逻辑中</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">Yue Dandy</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">Yue Dandy</a></h1>
            </hgroup>
            
            <p class="header-subtitle">Sense and Simplicity</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/Home">博客首页</a></li>
                
                    <li><a href="/About">作品展示</a></li>
                
                    <li><a href="https://www.zhihu.com/pub/">静心阅读</a></li>
                
                    <li><a href="https://www.vmovier.com/53766">光影之路</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-从Excel到Python——数据分析" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/06/02/从Excel到Python——数据分析/" class="article-date">
      <time datetime="2018-06-02T11:20:09.000Z" itemprop="datePublished">2018-06-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      从Excel到Python——数据分析
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Python/">Python</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据分析/">数据分析</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h1><p>Excel是数据分析中最常用的工具，本系列文章摘自蓝鲸老师的新书以及自己的一些扩充，该书通过Python与Excel的功能对比介绍如何使用Python通过函数式编程完成Excel中的数据处理及分析工作。在Python中pandas库用于数据处理，从1787页的pandas官网文档中总结出最常用的36个函数，通过这些函数介绍如何通过Python完成数据生成和导入、数据清洗、预处理，以及最常见的数据分类，数据筛选，分类汇总，透视等最常见的操作。</p>
<a id="more"></a>
<hr>
<h2 id="生成数据表"><a href="#生成数据表" class="headerlink" title="生成数据表"></a>生成数据表</h2><p> 常见的生成数据表的方法有两种，第一种是导入外部数据，第二种是直接写入数据。 </p>
<p> Python支持从多种类型的数据导入。在开始使用Python进行数据导入前需要先导入pandas库，为了方便起见，我们也同<br> 时导入numpy库。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br></pre></td></tr></table></figure>
<ul>
<li>在这篇文章中，我们使用如下缩写：<blockquote>
<p>df：任意的Pandas DataFrame对象<br>s：任意的Pandas Series对象</p>
</blockquote>
</li>
<li>Tips：对于数据科学家，无论是数据分析还是数据挖掘来说，Pandas是一个非常重要的Python包。它不仅提供了很多方法，使得数据处理非常简单，同时在数据处理速度上也做了很多优化，使得和Python内置方法相比时有了很大的优势。<br><strong>如果你想学习Pandas，建议先看两个网站。</strong></li>
</ul>
<p>（1）官网：<a href="http://pandas.pydata.org/" target="_blank" rel="noopener">Python Data Analysis</a></p>
<p>（2）十分钟入门Pandas ：<a href="http://pandas.pydata.org/pandas-docs/stable/10min.html" target="_blank" rel="noopener">10 Minutes to pandas</a></p>
<h3 id="导入数据表"><a href="#导入数据表" class="headerlink" title="导入数据表"></a>导入数据表</h3><p>下面分别是从excel和csv格式文件导入数据并创建数据表的方法。代码是最简模式，里面有很多可选参数设置，例如列名称，索引列，数据格式等等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">常用：</span><br><span class="line">df=pd.DataFrame(pd.read_csv(&apos;name.csv&apos;,header=1))</span><br><span class="line">df=pd.DataFrame(pd.read_excel(&apos;name.xlsx&apos;))</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">扩展：</span><br><span class="line">pd.read_table(filename)：从限定分隔符的文本文件导入数据</span><br><span class="line">pd.read_sql(query, connection_object)：从SQL表/库导入数据</span><br><span class="line">pd.read_json(json_string)：从JSON格式的字符串导入数据</span><br><span class="line">pd.read_html(url)：解析URL、字符串或者HTML文件，抽取其中的tables表格</span><br><span class="line">pd.read_clipboard()：从你的粘贴板获取内容，并传给read_table()</span><br><span class="line">pd.DataFrame(dict)：从字典对象导入数据，Key是列名，Value是数据</span><br></pre></td></tr></table></figure>
<h3 id="创建数据表"><a href="#创建数据表" class="headerlink" title="创建数据表"></a>创建数据表</h3><p>另一种方法是通过直接写入数据来生成数据表，excel中直接在单元格中输入数据就可以，python中通过下面的代码来实现。生成数据表的函数是pandas库中的DateFrame函数，数据表一共有6行数据，每行有6个字段。在数据中特意设置了一些NA值和有问题的字段，例如包含空格等。将在数据清洗步骤进行处理。统一以DataFrame的简称df来命名数据表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;&quot;id&quot;:[1001,1002,1003,1004,1005,1006],</span><br><span class="line">                   &quot;date&quot;:pd.date_range(&apos;20130102&apos;, periods=6),</span><br><span class="line">                   &quot;city&quot;:[&apos;Beijing &apos;, &apos;SH&apos;, &apos; guangzhou &apos;, &apos;Shenzhen&apos;, &apos;shanghai&apos;, &apos;BEIJING &apos;],</span><br><span class="line">                   &quot;age&quot;:[23,44,54,32,34,32],</span><br><span class="line">                   &quot;category&quot;:[&apos;100-A&apos;,&apos;100-B&apos;,&apos;110-A&apos;,&apos;110-C&apos;,&apos;210-A&apos;,&apos;130-F&apos;],</span><br><span class="line">                   &quot;price&quot;:[1200,np.nan,2133,5433,np.nan,4432]&#125;,</span><br><span class="line">                   columns =[&apos;id&apos;,&apos;date&apos;,&apos;city&apos;,&apos;category&apos;,&apos;age&apos;,&apos;price&apos;])</span><br></pre></td></tr></table></figure>
<p>这是刚刚创建的数据表，我们没有设置索引列，price字段中包含有NA值，city字段中还包含了一些脏数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df</span><br><span class="line"></span><br><span class="line">     id       date         city category  age   price</span><br><span class="line">0  1001 2013-01-02     Beijing     100-A   23  1200.0</span><br><span class="line">1  1002 2013-01-03           SH    100-B   44     NaN</span><br><span class="line">2  1003 2013-01-04   guangzhou     110-A   54  2133.0</span><br><span class="line">3  1004 2013-01-05     Shenzhen    110-C   32  5433.0</span><br><span class="line">4  1005 2013-01-06     shanghai    210-A   34     NaN</span><br><span class="line">5  1006 2013-01-07     BEIJING     130-F   32  4432.0</span><br></pre></td></tr></table></figure>
<h2 id="数据表检查"><a href="#数据表检查" class="headerlink" title="数据表检查"></a>数据表检查</h2><ul>
<li>对数据表进行检查，python中处理的数据量通常会比较大，数据量都在千万级，我们无法一目了然的 了解数据表的整体情况，必须要通过一些方法来获得数据表的关键信息。</li>
<li>数据表检查的另一个目的是了解数据的概况，例如整个数据表的大小，所占空间，数据格式，是否有空值和重复项和具体的数据内容。为清洗和预处理做好准备。</li>
</ul>
<h3 id="数据维度（行列）"><a href="#数据维度（行列）" class="headerlink" title="数据维度（行列）"></a>数据维度（行列）</h3><ul>
<li>Excel中可以通过CTRL+向下的光标键，和CTRL+向右的光标键来查看行号和列号。</li>
<li>Python中使用shape函数来查看数据表的维度，也就是行数和列数，函数返回的结果(6,6)表示数据表有6行，6列。下面是具体的代码。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df.shape</span><br><span class="line"></span><br><span class="line">(6, 6)</span><br></pre></td></tr></table></figure>
<h3 id="数据表信息"><a href="#数据表信息" class="headerlink" title="数据表信息"></a>数据表信息</h3><ul>
<li>使用info函数查看数据表的整体信息，这里返回的信息比较多，包括数据维度，列名称，数据格式和所占空间等信息。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">df.info()</span><br><span class="line"></span><br><span class="line">&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;</span><br><span class="line">RangeIndex: 6 entries, 0 to 5</span><br><span class="line">Data columns (total 6 columns):</span><br><span class="line">id          6 non-null int64</span><br><span class="line">date        6 non-null datetime64[ns]</span><br><span class="line">city        6 non-null object</span><br><span class="line">category    6 non-null object</span><br><span class="line">age         6 non-null int64</span><br><span class="line">price       4 non-null float64</span><br><span class="line">dtypes: datetime64[ns](1), float64(1), int64(2), object(2)</span><br><span class="line">memory usage: 368.0+ bytes</span><br></pre></td></tr></table></figure>
<h3 id="查看数据格式"><a href="#查看数据格式" class="headerlink" title="查看数据格式"></a>查看数据格式</h3><ul>
<li>Excel中通过选中单元格并查看开始菜单中的数值类型来判断数据的格式。Python中使用dtypes函数来返回数据格式。</li>
<li>dtypes是一个查看数据格式的函数，可以一次性查看数据表中所有数据的格式，也可以指定一列来单独查看。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 查看数据表各列格式</span><br><span class="line">df.dtypes</span><br><span class="line">Out[3]: </span><br><span class="line">id                   int64</span><br><span class="line">date        datetime64[ns]</span><br><span class="line">city                object</span><br><span class="line">category            object</span><br><span class="line">age                  int64</span><br><span class="line">price              float64</span><br><span class="line">dtype: object</span><br><span class="line"></span><br><span class="line">#查看单列格式</span><br><span class="line">df[&apos;city&apos;].dtype</span><br><span class="line">dtype(&apos;o&apos;)</span><br></pre></td></tr></table></figure>
<h3 id="查看空值"><a href="#查看空值" class="headerlink" title="查看空值"></a>查看空值</h3><ul>
<li>Excel中查看空值的方法是使用“定位条件”功能对数据表中的空值进行定位。“定位条件”在“开始”目录下的“查找和选择”目录中。</li>
<li>Isnull是Python中检验空值的函数，返回的结果是逻辑值，包含空值返回True，不包含则返回False。可以对整个数据表进行检查，也可以单独对某一列进行空值检查。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#检查数据空值</span><br><span class="line">df </span><br><span class="line">Out[8]: </span><br><span class="line">     id       date         city category  age   price</span><br><span class="line">0  1001 2013-01-02     Beijing     100-A   23  1200.0</span><br><span class="line">1  1002 2013-01-03           SH    100-B   44     NaN</span><br><span class="line">2  1003 2013-01-04   guangzhou     110-A   54  2133.0</span><br><span class="line">3  1004 2013-01-05     Shenzhen    110-C   32  5433.0</span><br><span class="line">4  1005 2013-01-06     shanghai    210-A   34     NaN</span><br><span class="line">5  1006 2013-01-07     BEIJING     130-F   32  4432.0</span><br><span class="line"></span><br><span class="line">df.isnull()</span><br><span class="line">Out[9]: </span><br><span class="line">      id   date   city  category    age  price</span><br><span class="line">0  False  False  False     False  False  False</span><br><span class="line">1  False  False  False     False  False   True</span><br><span class="line">2  False  False  False     False  False  False</span><br><span class="line">3  False  False  False     False  False  False</span><br><span class="line">4  False  False  False     False  False   True</span><br><span class="line">5  False  False  False     False  False  False</span><br><span class="line"></span><br><span class="line">#检查特定列空值</span><br><span class="line">df[&apos;price&apos;].isnull()</span><br><span class="line">Out[10]:  </span><br><span class="line">0    False</span><br><span class="line">1     True</span><br><span class="line">2    False</span><br><span class="line">3    False</span><br><span class="line">4     True</span><br><span class="line">5    False</span><br><span class="line">Name: price, dtype: bool</span><br></pre></td></tr></table></figure>
<h3 id="查看唯一值"><a href="#查看唯一值" class="headerlink" title="查看唯一值"></a>查看唯一值</h3><ul>
<li>Excel中查看唯一值的方法是使用“条件格式”对唯一值进行颜色标记。Python中使用unique函数查看唯一值。</li>
<li>Unique是查看唯一值的函数，只能对数据表中的特定列进行检查。下面是代码，返回的结果是该列中的唯一值。类似与Excel中删除重复项后的结果。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#查看city列中的唯一值</span><br><span class="line">df[&apos;city&apos;].unique()</span><br><span class="line">Out[11]: </span><br><span class="line">array([&apos;Beijing &apos;, &apos;SH&apos;, &apos; guangzhou &apos;, &apos;Shenzhen&apos;, &apos;shanghai&apos;, &apos;BEIJING &apos;], dtype=object)</span><br></pre></td></tr></table></figure>
<h3 id="查看数据表数值"><a href="#查看数据表数值" class="headerlink" title="查看数据表数值"></a>查看数据表数值</h3><p>Python中的Values函数用来查看数据表中的数值。以数组的形式返回，不包含表头信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#查看数据表的值</span><br><span class="line">df.values</span><br><span class="line">Out[12]: </span><br><span class="line">array([[1001, Timestamp(&apos;2013-01-02 00:00:00&apos;), &apos;Beijing &apos;, &apos;100-A&apos;, 23,</span><br><span class="line">        1200.0],</span><br><span class="line">       [1002, Timestamp(&apos;2013-01-03 00:00:00&apos;), &apos;SH&apos;, &apos;100-B&apos;, 44, nan],</span><br><span class="line">       [1003, Timestamp(&apos;2013-01-04 00:00:00&apos;), &apos; guangzhou &apos;, &apos;110-A&apos;, 54,</span><br><span class="line">        2133.0],</span><br><span class="line">       [1004, Timestamp(&apos;2013-01-05 00:00:00&apos;), &apos;Shenzhen&apos;, &apos;110-C&apos;, 32,</span><br><span class="line">        5433.0],</span><br><span class="line">       [1005, Timestamp(&apos;2013-01-06 00:00:00&apos;), &apos;shanghai&apos;, &apos;210-A&apos;, 34,</span><br><span class="line">        nan],</span><br><span class="line">       [1006, Timestamp(&apos;2013-01-07 00:00:00&apos;), &apos;BEIJING &apos;, &apos;130-F&apos;, 32,</span><br><span class="line">        4432.0]], dtype=object)</span><br></pre></td></tr></table></figure>
<h3 id="查看列名称"><a href="#查看列名称" class="headerlink" title="查看列名称"></a>查看列名称</h3><p>Colums函数用来单独查看数据表中的列名称。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#查看列名称</span><br><span class="line">df.columns</span><br><span class="line">Out[13]: </span><br><span class="line">Index([&apos;id&apos;, &apos;date&apos;, &apos;city&apos;, &apos;category&apos;, &apos;age&apos;, &apos;price&apos;], dtype=&apos;object&apos;)</span><br></pre></td></tr></table></figure>
<h3 id="查看前3行数据"><a href="#查看前3行数据" class="headerlink" title="查看前3行数据"></a>查看前3行数据</h3><p>Head函数用来查看数据表中的前N行数据，默认head()显示前10行数据，可以自己设置参数值来确定查看的行数。下面的代码中设置查看前3行的数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#查看前3行数据</span><br><span class="line">df.head(3)</span><br><span class="line">Out[14]:</span><br><span class="line"> id       date         city category  age   price</span><br><span class="line">0  1001 2013-01-02     Beijing     100-A   23  1200.0</span><br><span class="line">1  1002 2013-01-03           SH    100-B   44     NaN</span><br><span class="line">2  1003 2013-01-04   guangzhou     110-A   54  2133.0</span><br></pre></td></tr></table></figure>
<h3 id="查看后10行数据"><a href="#查看后10行数据" class="headerlink" title="查看后10行数据"></a>查看后10行数据</h3><p>Tail行数与head函数相反，用来查看数据表中后N行的数据，默认tail()显示后10行数据，可以自己设置参数值来确定查看的行数。下面的代码中设置查看后3行的数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#查看最后3行</span><br><span class="line">df.tail(3)</span><br><span class="line">Out[15]:</span><br><span class="line">id       date      city category  age   price</span><br><span class="line">3  1004 2013-01-05  Shenzhen    110-C   32  5433.0</span><br><span class="line">4  1005 2013-01-06  shanghai    210-A   34     NaN</span><br><span class="line">5  1006 2013-01-07  BEIJING     130-F   32  4432.0</span><br></pre></td></tr></table></figure>
<h2 id="数据清洗"><a href="#数据清洗" class="headerlink" title="数据清洗"></a>数据清洗</h2><p>对数据表中的问题进行清洗。主要内容包括对空值，大小写问题，数据格式和重复值的处理。这里不包含对数据间的逻辑验证。</p>
<h3 id="处理空值-删除或填充"><a href="#处理空值-删除或填充" class="headerlink" title="处理空值(删除或填充)"></a>处理空值(删除或填充)</h3><p>在创建数据表的时候在price字段中故意设置了几个NA值。对于空值的处理方式有很多种，可以直接删除包含空值的数据，也可以对空值进行填充，比如用0填充或者用均值填充。还可以根据不同字段的逻辑对空值进行推算。</p>
<ul>
<li>Excel中可以通过“查找和替换”功能对空值进行处理，将空值统一替换为0或均值。也可以通过“定位”空值来实现。</li>
<li>Python中处理空值的方法比较灵活，可以使用Dropna函数用来删除数据表中包含空值的数据，也可以使用fillna函数对空值进行填充。<br>Parameters:<blockquote>
<p>axis : {0 or ‘index’, 1 or ‘columns’}, default 0</p>
</blockquote>
</li>
<li>0, or ‘index’ : 删掉包含空值的行</li>
<li>1, or ‘columns’ : 删掉包含空值的列<blockquote>
<p>how : {‘any’, ‘all’}, default ‘any’</p>
</blockquote>
</li>
<li>any: 有NA，删掉行或列</li>
<li>all：所有值为NA，删掉行或列<blockquote>
<p>thresh : int, optional</p>
</blockquote>
</li>
<li>需要非空值限制  </li>
<li>df.dropna(thresh=2)</li>
<li>Keep only the rows with at least 2 non-NA values.<blockquote>
<p>inplace :bool, default False</p>
</blockquote>
</li>
<li>Keep the DataFrame with valid entries in the same variable.</li>
<li>df.dropna(inplace=True)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#删除数据表中含有空值的行</span><br><span class="line">df.dropna()</span><br><span class="line">Out[16]: </span><br><span class="line">     id       date         city category  age   price</span><br><span class="line">0  1001 2013-01-02     Beijing     100-A   23  1200.0</span><br><span class="line">2  1003 2013-01-04   guangzhou     110-A   54  2133.0</span><br><span class="line">3  1004 2013-01-05     Shenzhen    110-C   32  5433.0</span><br><span class="line">5  1006 2013-01-07     BEIJING     130-F   32  4432.0</span><br></pre></td></tr></table></figure>
<p>除此之外也可以使用数字对空值进行填充，下面的代码使用fillna函数对空值字段填充数字0。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#使用数字0填充数据表中空值</span><br><span class="line">df.fillna(value=0)</span><br></pre></td></tr></table></figure>
<p>选择填充的方式来处理空值，使用price列的均值来填充NA字段，同样使用fillna函数，在要填充的数值中使用mean函数先计算price列当前的均值，然后使用这个均值对NA进行填充。可以看到两个空值字段显示为3299.5.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 使用price均值对NA进行填充</span><br><span class="line">df[&apos;price&apos;].fillna(df[&apos;price&apos;].mean())</span><br><span class="line">Out[17]: </span><br><span class="line">0    1200.0</span><br><span class="line">1    3299.5</span><br><span class="line">2    2133.0</span><br><span class="line">3    5433.0</span><br><span class="line">4    3299.5</span><br><span class="line">5    4432.0</span><br><span class="line">Name: price, dtype: float64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[&apos;price&apos;] = df[&apos;price&apos;].fillna(df[&apos;price&apos;].mean())</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df</span><br><span class="line">Out[18]: </span><br><span class="line">     id       date         city category  age   price</span><br><span class="line">0  1001 2013-01-02     Beijing     100-A   23  1200.0</span><br><span class="line">1  1002 2013-01-03           SH    100-B   44  3299.5</span><br><span class="line">2  1003 2013-01-04   guangzhou     110-A   54  2133.0</span><br><span class="line">3  1004 2013-01-05     Shenzhen    110-C   32  5433.0</span><br><span class="line">4  1005 2013-01-06     shanghai    210-A   34  3299.5</span><br><span class="line">5  1006 2013-01-07     BEIJING     130-F   32  4432.0</span><br></pre></td></tr></table></figure>
<h3 id="清理表格"><a href="#清理表格" class="headerlink" title="清理表格"></a>清理表格</h3><p>除了空值，字符中的空格也是数据清洗中一个常见的问题，下面是清除字符中空格的代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#清除city字段中的字符空格</span><br><span class="line">df[&apos;city&apos;]=df[&apos;city&apos;].map(str.strip)</span><br></pre></td></tr></table></figure>
<h3 id="大小写转换"><a href="#大小写转换" class="headerlink" title="大小写转换"></a>大小写转换</h3><p>在英文字段中，字母的大小写不统一也是一个常见的问题。Excel中有UPPER，LOWER等函数，python中也有同名函数用来解决大小写的问题。在数据表的city列中就存在这样的问题。将city列的所有字母转换为小写。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#city列大小写转换</span><br><span class="line">df[&apos;city&apos;]=df[&apos;city&apos;].str.lower()</span><br><span class="line"></span><br><span class="line">df</span><br><span class="line">Out[29]: </span><br><span class="line">     id       date       city category  age   price</span><br><span class="line">0  1001 2013-01-02    beijing    100-A   23  1200.0</span><br><span class="line">1  1002 2013-01-03         sh    100-B   44  3299.5</span><br><span class="line">2  1003 2013-01-04  guangzhou    110-A   54  2133.0</span><br><span class="line">3  1004 2013-01-05   shenzhen    110-C   32  5433.0</span><br><span class="line">4  1005 2013-01-06   shanghai    210-A   34  3299.5</span><br><span class="line">5  1006 2013-01-07    beijing    130-F   32  4432.0</span><br></pre></td></tr></table></figure>
<h3 id="更改数据格式"><a href="#更改数据格式" class="headerlink" title="更改数据格式"></a>更改数据格式</h3><ul>
<li>Excel中通过“设置单元格格式”功能可以修改数据格式。Python中通过astype函数用来修改数据格式。</li>
<li>Python中dtype是查看数据格式的函数，与之对应的是astype函数，用来更改数据格式。下面的代码中将price字段的值修改为int格式。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df[&apos;price&apos;].astype(&apos;int&apos;)</span><br><span class="line">Out[30]:  </span><br><span class="line">0    1200</span><br><span class="line">1    3299</span><br><span class="line">2    2133</span><br><span class="line">3    5433</span><br><span class="line">4    3299</span><br><span class="line">5    4432</span><br><span class="line">Name: price, dtype: int32</span><br></pre></td></tr></table></figure>
<h3 id="更改列名字"><a href="#更改列名字" class="headerlink" title="更改列名字"></a>更改列名字</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#更改列名称</span><br><span class="line">df = df.rename(columns=&#123;&apos;category&apos;: &apos;category-size&apos;&#125;)</span><br><span class="line">df</span><br><span class="line">Out[31]: </span><br><span class="line">     id       date       city category-size  age  price</span><br><span class="line">0  1001 2013-01-02    beijing         100-A   23   1200</span><br><span class="line">1  1002 2013-01-03         sh         100-B   44   3299</span><br><span class="line">2  1003 2013-01-04  guangzhou         110-A   54   2133</span><br><span class="line">3  1004 2013-01-05   shenzhen         110-C   32   5433</span><br><span class="line">4  1005 2013-01-06   shanghai         210-A   34   3299</span><br><span class="line">5  1006 2013-01-07    beijing         130-F   32   4432</span><br></pre></td></tr></table></figure>
<h3 id="删除重复值"><a href="#删除重复值" class="headerlink" title="删除重复值"></a>删除重复值</h3><ul>
<li>很多数据表中还包含重复值的问题，Excel的数据目录下有“删除重复项”的功能，可以用来删除数据表中的重复值。默认Excel会保留最先出现的数据，删除后面重复出现的数据。</li>
<li>Python中使用drop_duplicates函数删除重复值。我们以数据表中的city列为例，city字段中存在重复值。默认情况下drop_duplicates()将删除后出现的重复值(与excel逻辑一致)。增加keep=’last’参数后将删除最先出现的重复值，保留最后的值。下面是具体的代码和比较结果。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># city列中beijing存在重复，分别在第一位和最后一位。</span><br><span class="line">df[&apos;city&apos;]</span><br><span class="line">0      beijing</span><br><span class="line">1           sh</span><br><span class="line">2    guangzhou</span><br><span class="line">3     shenzhen</span><br><span class="line">4     shanghai</span><br><span class="line">5      beijing</span><br><span class="line">Name: city, dtype: object</span><br></pre></td></tr></table></figure>
<p>使用默认的drop_duplicates()函数删除重复值，从结果中可以看到第一位的beijing被保留，最后出现的beijing被删除。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#删除后出现的重复值</span><br><span class="line">df[&apos;city&apos;].drop_duplicates()</span><br><span class="line">0      beijing</span><br><span class="line">1           sh</span><br><span class="line">2    guangzhou</span><br><span class="line">3     shenzhen</span><br><span class="line">4     shanghai</span><br><span class="line">Name: city, dtype: object</span><br></pre></td></tr></table></figure>
<p>设置keep=’last‘’参数后，与之前删除重复值的结果相反，第一位出现的beijing被删除，保留了最后一位出现的beijing。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#删除先出现的重复值</span><br><span class="line">df[&apos;city&apos;].drop_duplicates(keep=&apos;last&apos;)</span><br><span class="line">1           sh</span><br><span class="line">2    guangzhou</span><br><span class="line">3     shenzhen</span><br><span class="line">4     shanghai</span><br><span class="line">5      beijing</span><br><span class="line">Name: city, dtype: objec</span><br></pre></td></tr></table></figure>
<h3 id="数值修改和替换"><a href="#数值修改和替换" class="headerlink" title="数值修改和替换"></a>数值修改和替换</h3><p>数据清洗中最后一个问题是数值修改或替。</p>
<ul>
<li>Excel中使用“查找和替换”功能就可以实现数值的替换。</li>
<li>Python中使用replace函数实现数据替换。数据表中city字段上海存在两种写法，分别为shanghai和SH。我们使用replace函数对SH进行替换。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#数据替换</span><br><span class="line">df[&apos;city&apos;].replace(&apos;sh&apos;, &apos;shanghai&apos;)</span><br><span class="line">0      beijing</span><br><span class="line">1     shanghai</span><br><span class="line">2    guangzhou</span><br><span class="line">3     shenzhen</span><br><span class="line">4     shanghai</span><br><span class="line">5      beijing</span><br><span class="line">Name: city, dtype: object</span><br></pre></td></tr></table></figure>
<h2 id="数据预处理"><a href="#数据预处理" class="headerlink" title="数据预处理"></a>数据预处理</h2><p>数据的预处理，对清洗完的数据进行整理以便后期的统计和分析工作。主要包括数据表的合并，排序，数值分列，数据分组及标记等工作。</p>
<h3 id="数据表合并"><a href="#数据表合并" class="headerlink" title="数据表合并"></a>数据表合并</h3><p>对不同的数据表进行合并，首先创建一个新的数据表df1，并将df和df1两个数据表进行合并。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 创建df1数据表</span><br><span class="line">df1=pd.DataFrame(&#123;&quot;id&quot;:[1001,1002,1003,1004,1005,1006,1007,1008],</span><br><span class="line">&quot;gender&quot;:[&apos;male&apos;,&apos;female&apos;,&apos;male&apos;,&apos;female&apos;,&apos;male&apos;,&apos;female&apos;,&apos;male&apos;,&apos;female&apos;],</span><br><span class="line">&quot;pay&quot;:[&apos;Y&apos;,&apos;N&apos;,&apos;Y&apos;,&apos;Y&apos;,&apos;N&apos;,&apos;Y&apos;,&apos;N&apos;,&apos;Y&apos;,],</span><br><span class="line">&quot;m-point&quot;:[10,12,20,40,40,40,30,20]&#125;)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>gender</th>
<th>id</th>
<th>m-point</th>
<th>pay</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>male</td>
<td>1001</td>
<td>10</td>
<td>Y</td>
</tr>
<tr>
<td>1</td>
<td>female</td>
<td>1002</td>
<td>12</td>
<td>N</td>
</tr>
<tr>
<td>2</td>
<td>male</td>
<td>1003</td>
<td>20</td>
<td>Y</td>
</tr>
<tr>
<td>3</td>
<td>female</td>
<td>1004</td>
<td>40</td>
<td>Y</td>
</tr>
<tr>
<td>4</td>
<td>male</td>
<td>1005</td>
<td>40</td>
<td>N</td>
</tr>
<tr>
<td>5</td>
<td>female</td>
<td>1006</td>
<td>40</td>
<td>Y</td>
</tr>
<tr>
<td>6</td>
<td>male</td>
<td>1007</td>
<td>30</td>
<td>N</td>
</tr>
<tr>
<td>7</td>
<td>female</td>
<td>1008</td>
<td>20</td>
<td>Y </td>
</tr>
</tbody>
</table>
<p>使用merge函数对两个数据表进行合并，合并的方式为inner，将两个数据表中共有的数据匹配到一起生成新的数据表。并命名为df_inner。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner=pd.merge(df,df1,how=&apos;inner&apos;)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>id</th>
<th>date</th>
<th>city</th>
<th>category</th>
<th>age</th>
<th>price</th>
<th>gender</th>
<th>m-point</th>
<th>pay  </th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1001</td>
<td>2013-01-02</td>
<td>beijing</td>
<td>100-A</td>
<td>23</td>
<td>1200</td>
<td>male</td>
<td>10</td>
<td>Y </td>
</tr>
<tr>
<td>1</td>
<td>1002</td>
<td>2013-01-03</td>
<td>shanghai</td>
<td>100-B</td>
<td>44</td>
<td>3299</td>
<td>female</td>
<td>12</td>
<td>N </td>
</tr>
<tr>
<td>2</td>
<td>1003</td>
<td>2013-01-04</td>
<td>guangzhou</td>
<td>110-A</td>
<td>54</td>
<td>2133</td>
<td>male</td>
<td>20</td>
<td>Y</td>
</tr>
<tr>
<td>3</td>
<td>1004</td>
<td>2013-01-05</td>
<td>shenzhen</td>
<td>110-C</td>
<td>32</td>
<td>5433</td>
<td>female</td>
<td>40</td>
<td>Y </td>
</tr>
<tr>
<td>4</td>
<td>1005</td>
<td>2013-01-06</td>
<td>shanghai</td>
<td>210-A</td>
<td>34</td>
<td>3299</td>
<td>male</td>
<td>40</td>
<td>N</td>
</tr>
<tr>
<td>5</td>
<td>1006</td>
<td>2013-01-07</td>
<td>beijing</td>
<td>130-F</td>
<td>32</td>
<td>4432</td>
<td>female</td>
<td>40</td>
<td>Y</td>
</tr>
</tbody>
</table>
<p>how除了inner方式以外，合并的方式还有left,right和outer方式。</p>
<h3 id="设置索引列"><a href="#设置索引列" class="headerlink" title="设置索引列"></a>设置索引列</h3><p>完成数据表的合并后，我们对df_inner数据表设置索引列，索引列的功能很多，可以进行数据提取，汇总，也可以进行数据筛选等。设置索引的函数为set_index。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.set_index(&apos;id&apos;)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>date</th>
<th>city</th>
<th>category</th>
<th>age</th>
<th>price</th>
<th>gender</th>
<th>m-point</th>
<th>pay  </th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1001</td>
<td>2013-01-02</td>
<td>beijing</td>
<td>100-A</td>
<td>23</td>
<td>1200</td>
<td>male</td>
<td>10</td>
<td>Y </td>
</tr>
<tr>
<td>1002</td>
<td>2013-01-03</td>
<td>shanghai</td>
<td>100-B</td>
<td>44</td>
<td>3299</td>
<td>female</td>
<td>12</td>
<td>N </td>
</tr>
<tr>
<td>1003</td>
<td>2013-01-04</td>
<td>guangzhou</td>
<td>110-A</td>
<td>54</td>
<td>2133</td>
<td>male</td>
<td>20</td>
<td>Y</td>
</tr>
<tr>
<td>1004</td>
<td>2013-01-05</td>
<td>shenzhen</td>
<td>110-C</td>
<td>32</td>
<td>5433</td>
<td>female</td>
<td>40</td>
<td>Y </td>
</tr>
<tr>
<td>1005</td>
<td>2013-01-06</td>
<td>shanghai</td>
<td>210-A</td>
<td>34</td>
<td>3299</td>
<td>male</td>
<td>40</td>
<td>N</td>
</tr>
<tr>
<td>1006</td>
<td>2013-01-07</td>
<td>beijing</td>
<td>130-F</td>
<td>32</td>
<td>4432</td>
<td>female</td>
<td>40</td>
<td>Y</td>
</tr>
</tbody>
</table>
<h3 id="排序（按索引，按数值）"><a href="#排序（按索引，按数值）" class="headerlink" title="排序（按索引，按数值）"></a>排序（按索引，按数值）</h3><p>Excel中可以通过数据目录下的排序按钮直接对数据表进行排序，比较简单。Python中需要使用sort_values函数和sort_index函数完成排序。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_innner.sort_values(by=[&apos;age&apos;])</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>id</th>
<th>date</th>
<th>city</th>
<th>category</th>
<th>age</th>
<th>price</th>
<th>gender</th>
<th>m-point</th>
<th>pay  </th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1001</td>
<td>2013-01-02</td>
<td>beijing</td>
<td>100-A</td>
<td>23</td>
<td>1200</td>
<td>male</td>
<td>10</td>
<td>Y </td>
</tr>
<tr>
<td>3</td>
<td>1004</td>
<td>2013-01-05</td>
<td>shenzhen</td>
<td>110-C</td>
<td>32</td>
<td>5433</td>
<td>female</td>
<td>40</td>
<td>Y </td>
</tr>
<tr>
<td>5</td>
<td>1006</td>
<td>2013-01-07</td>
<td>beijing</td>
<td>130-F</td>
<td>32</td>
<td>4432</td>
<td>female</td>
<td>40</td>
<td>Y</td>
</tr>
<tr>
<td>4</td>
<td>1005</td>
<td>2013-01-06</td>
<td>shanghai</td>
<td>210-A</td>
<td>34</td>
<td>3299</td>
<td>male</td>
<td>40</td>
<td>N</td>
</tr>
<tr>
<td>1</td>
<td>1002</td>
<td>2013-01-03</td>
<td>shanghai</td>
<td>100-B</td>
<td>44</td>
<td>3299</td>
<td>female</td>
<td>12</td>
<td>N </td>
</tr>
<tr>
<td>2</td>
<td>1003</td>
<td>2013-01-04</td>
<td>guangzhou</td>
<td>110-A</td>
<td>54</td>
<td>2133</td>
<td>male</td>
<td>20</td>
<td>Y</td>
</tr>
</tbody>
</table>
<p>Sort_index函数用来将数据表按索引列的值进行排序。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.sort_index()</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>id</th>
<th>date</th>
<th>city</th>
<th>category</th>
<th>age</th>
<th>price</th>
<th>gender</th>
<th>m-point</th>
<th>pay  </th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1001</td>
<td>2013-01-02</td>
<td>beijing</td>
<td>100-A</td>
<td>23</td>
<td>1200</td>
<td>male</td>
<td>10</td>
<td>Y </td>
</tr>
<tr>
<td>1</td>
<td>1002</td>
<td>2013-01-03</td>
<td>shanghai</td>
<td>100-B</td>
<td>44</td>
<td>3299</td>
<td>female</td>
<td>12</td>
<td>N </td>
</tr>
<tr>
<td>2</td>
<td>1003</td>
<td>2013-01-04</td>
<td>guangzhou</td>
<td>110-A</td>
<td>54</td>
<td>2133</td>
<td>male</td>
<td>20</td>
<td>Y</td>
</tr>
<tr>
<td>3</td>
<td>1004</td>
<td>2013-01-05</td>
<td>shenzhen</td>
<td>110-C</td>
<td>32</td>
<td>5433</td>
<td>female</td>
<td>40</td>
<td>Y </td>
</tr>
<tr>
<td>4</td>
<td>1005</td>
<td>2013-01-06</td>
<td>shanghai</td>
<td>210-A</td>
<td>34</td>
<td>3299</td>
<td>male</td>
<td>40</td>
<td>N</td>
</tr>
<tr>
<td>5</td>
<td>1006</td>
<td>2013-01-07</td>
<td>beijing</td>
<td>130-F</td>
<td>32</td>
<td>4432</td>
<td>female</td>
<td>40</td>
<td>Y</td>
</tr>
</tbody>
</table>
<h3 id="数据分组"><a href="#数据分组" class="headerlink" title="数据分组"></a>数据分组</h3><p>Excel中可以通过VLOOKUP函数进行近似匹配来完成对数值的分组，或者使用“数据透视表”来完成分组。相应的 python中使用where函数完成数据分组。</p>
<p>Where函数用来对数据进行判断和分组，下面的代码中我们对price列的值进行判断，将符合条件的分为一组，不符合条件的分为另一组，并使用group字段进行标记。</p>
<ul>
<li>如果price列的值&gt;3000，group列显示high，否则显示low。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner[&apos;group&apos;] = np.where(df_inner[&apos;price&apos;] &gt; 3000,&apos;high&apos;,&apos;low&apos;)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>id</th>
<th>date</th>
<th>city</th>
<th>category</th>
<th>age</th>
<th>price</th>
<th>gender</th>
<th>m-point</th>
<th>pay</th>
<th>group</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1001</td>
<td>2013-01-02</td>
<td>beijing</td>
<td>100-A</td>
<td>23</td>
<td>1200</td>
<td>male</td>
<td>10</td>
<td>Y</td>
<td>low</td>
</tr>
<tr>
<td>3</td>
<td>1004</td>
<td>2013-01-05</td>
<td>shenzhen</td>
<td>110-C</td>
<td>32</td>
<td>5433</td>
<td>female</td>
<td>40</td>
<td>Y</td>
<td>high</td>
</tr>
<tr>
<td>5</td>
<td>1006</td>
<td>2013-01-07</td>
<td>beijing</td>
<td>130-F</td>
<td>32</td>
<td>4432</td>
<td>female</td>
<td>40</td>
<td>Y</td>
<td>high</td>
</tr>
<tr>
<td>4</td>
<td>1005</td>
<td>2013-01-06</td>
<td>shanghai</td>
<td>210-A</td>
<td>34</td>
<td>3299</td>
<td>male</td>
<td>40</td>
<td>N</td>
<td>high </td>
</tr>
<tr>
<td>1</td>
<td>1002</td>
<td>2013-01-03</td>
<td>shanghai</td>
<td>100-B</td>
<td>44</td>
<td>3299</td>
<td>female</td>
<td>12</td>
<td>N</td>
<td>high</td>
</tr>
<tr>
<td>2</td>
<td>1003</td>
<td>2013-01-04</td>
<td>guangzhou</td>
<td>110-A</td>
<td>54</td>
<td>2133</td>
<td>male</td>
<td>20</td>
<td>Y</td>
<td>low</td>
</tr>
</tbody>
</table>
<p>除了where函数以外，还可以对多个字段的值进行判断后对数据进行分组，下面的代码中对city列等于beijing并且price列大于等于4000的数据标记为1。</p>
<ul>
<li>对复合多个条件的数据进行分组标记</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.loc[(df_inner[&apos;city&apos;] == &apos;beijing&apos;) &amp; (df_inner[&apos;price&apos;] &gt;= 4000), &apos;sign&apos;]=1</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>id</th>
<th>date</th>
<th>city</th>
<th>category</th>
<th>age</th>
<th>price</th>
<th>gender</th>
<th>m-point</th>
<th>pay</th>
<th>group</th>
<th>sigh</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1001</td>
<td>2013-01-02</td>
<td>beijing</td>
<td>100-A</td>
<td>23</td>
<td>1200</td>
<td>male</td>
<td>10</td>
<td>Y</td>
<td>low</td>
<td>NaN</td>
</tr>
<tr>
<td>3</td>
<td>1004</td>
<td>2013-01-05</td>
<td>shenzhen</td>
<td>110-C</td>
<td>32</td>
<td>5433</td>
<td>female</td>
<td>40</td>
<td>Y</td>
<td>high</td>
<td>NaN</td>
</tr>
<tr>
<td>5</td>
<td>1006</td>
<td>2013-01-07</td>
<td>beijing</td>
<td>130-F</td>
<td>32</td>
<td>4432</td>
<td>female</td>
<td>40</td>
<td>Y</td>
<td>high</td>
<td>1.0</td>
</tr>
<tr>
<td>4</td>
<td>1005</td>
<td>2013-01-06</td>
<td>shanghai</td>
<td>210-A</td>
<td>34</td>
<td>3299</td>
<td>male</td>
<td>40</td>
<td>N</td>
<td>high</td>
<td>NaN</td>
</tr>
<tr>
<td>1</td>
<td>1002</td>
<td>2013-01-03</td>
<td>shanghai</td>
<td>100-B</td>
<td>44</td>
<td>3299</td>
<td>female</td>
<td>12</td>
<td>N</td>
<td>high</td>
<td>NaN</td>
</tr>
<tr>
<td>2</td>
<td>1003</td>
<td>2013-01-04</td>
<td>guangzhou</td>
<td>110-A</td>
<td>54</td>
<td>2133</td>
<td>male</td>
<td>20</td>
<td>Y</td>
<td>low</td>
<td>NaN</td>
</tr>
</tbody>
</table>
<h3 id="数据分列"><a href="#数据分列" class="headerlink" title="数据分列"></a>数据分列</h3><p>与数据分组相反的是对数值进行分列，Excel中的数据目录下提供“分列”功能。在python中使用split函数实现分列。</p>
<p>在数据表中category列中的数据包含有两个信息，前面的数字为类别id，后面的字母为size值。中间以连字符进行连接。我们使用split函数对这个字段进行拆分，并将拆分后的数据表匹配回原数据表中。</p>
<ul>
<li>对category字段的值依次进行分列，并创建数据表，索引值为df_inner的索引列，列名称为category和size。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">split = pd.DataFrame((x.split(&apos;-&apos;) for x in df_inner[&apos;category&apos;]),index=df_inner.index,columns=[&apos;category&apos;,&apos;size&apos;])</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>id</th>
<th>date</th>
<th>city</th>
<th>category</th>
<th>age</th>
<th>price</th>
<th>gender</th>
<th>m-point</th>
<th>pay</th>
<th>group</th>
<th>sigh</th>
<th>catrgory_1</th>
<th>size </th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1001</td>
<td>2013-01-02</td>
<td>beijing</td>
<td>100-A</td>
<td>23</td>
<td>1200</td>
<td>male</td>
<td>10</td>
<td>Y</td>
<td>low</td>
<td>NaN</td>
<td>100</td>
<td>A</td>
</tr>
<tr>
<td>3</td>
<td>1004</td>
<td>2013-01-05</td>
<td>shenzhen</td>
<td>110-C</td>
<td>32</td>
<td>5433</td>
<td>female</td>
<td>40</td>
<td>Y</td>
<td>high</td>
<td>NaN</td>
<td>110</td>
<td>C</td>
</tr>
<tr>
<td>5</td>
<td>1006</td>
<td>2013-01-07</td>
<td>beijing</td>
<td>130-F</td>
<td>32</td>
<td>4432</td>
<td>female</td>
<td>40</td>
<td>Y</td>
<td>high</td>
<td>1.0</td>
<td>130</td>
<td>F</td>
</tr>
<tr>
<td>4</td>
<td>1005</td>
<td>2013-01-06</td>
<td>shanghai</td>
<td>210-A</td>
<td>34</td>
<td>3299</td>
<td>male</td>
<td>40</td>
<td>N</td>
<td>high</td>
<td>NaN</td>
<td>210</td>
<td>A</td>
</tr>
<tr>
<td>1</td>
<td>1002</td>
<td>2013-01-03</td>
<td>shanghai</td>
<td>100-B</td>
<td>44</td>
<td>3299</td>
<td>female</td>
<td>12</td>
<td>N</td>
<td>high</td>
<td>NaN</td>
<td>100</td>
<td>B</td>
</tr>
<tr>
<td>2</td>
<td>1003</td>
<td>2013-01-04</td>
<td>guangzhou</td>
<td>110-A</td>
<td>54</td>
<td>2133</td>
<td>male</td>
<td>20</td>
<td>Y</td>
<td>low</td>
<td>NaN</td>
<td>110</td>
<td>A</td>
</tr>
</tbody>
</table>
<h2 id="数据提取"><a href="#数据提取" class="headerlink" title="数据提取"></a>数据提取</h2><p>数据提取，是数据分析中最常见的一个工作。这部分主要使用三个函数，loc，iloc和ix，loc函数按标签值进行提取，iloc按位置进行提取，ix可以同时按标签和位置进行提取。</p>
<h3 id="按标签提取（loc）"><a href="#按标签提取（loc）" class="headerlink" title="按标签提取（loc）"></a>按标签提取（loc）</h3><ul>
<li>按索引提取单行的数值</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.loc[3]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>id</th>
<th>date</th>
<th>city</th>
<th>category</th>
<th>age</th>
<th>price</th>
<th>gender</th>
<th>m-point</th>
<th>pay</th>
<th>group</th>
<th>sigh</th>
<th>catrgory_1</th>
<th>size </th>
</tr>
</thead>
<tbody>
<tr>
<td>1004</td>
<td>2013-01-05</td>
<td>shenzhen</td>
<td>110-C</td>
<td>32</td>
<td>5433</td>
<td>female</td>
<td>40</td>
<td>Y</td>
<td>high</td>
<td>NaN</td>
<td>110</td>
<td>C</td>
</tr>
</tbody>
</table>
<p>使用冒号可以限定提取数据的范围，冒号前面为开始的标签值，后面为结束的标签值。下面提取了0到5的数据行。</p>
<ul>
<li>按索引提取区域行数值<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.loc[0:5]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>id</th>
<th>date</th>
<th>city</th>
<th>category</th>
<th>age</th>
<th>price</th>
<th>gender</th>
<th>m-point</th>
<th>pay</th>
<th>group</th>
<th>sigh</th>
<th>catrgory_1</th>
<th>size </th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1001</td>
<td>2013-01-02</td>
<td>beijing</td>
<td>100-A</td>
<td>23</td>
<td>1200</td>
<td>male</td>
<td>10</td>
<td>Y</td>
<td>low</td>
<td>NaN</td>
<td>100</td>
<td>A</td>
</tr>
<tr>
<td>3</td>
<td>1004</td>
<td>2013-01-05</td>
<td>shenzhen</td>
<td>110-C</td>
<td>32</td>
<td>5433</td>
<td>female</td>
<td>40</td>
<td>Y</td>
<td>high</td>
<td>NaN</td>
<td>110</td>
<td>C</td>
</tr>
<tr>
<td>5</td>
<td>1006</td>
<td>2013-01-07</td>
<td>beijing</td>
<td>130-F</td>
<td>32</td>
<td>4432</td>
<td>female</td>
<td>40</td>
<td>Y</td>
<td>high</td>
<td>1.0</td>
<td>130</td>
<td>F</td>
</tr>
</tbody>
</table>
<p>Reset_index函数用于恢复索引，这里我们重新将date字段的日期设置为数据表的索引，并按日期进行数据提取。</p>
<ul>
<li>重设索引<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.reset_index()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>index</th>
<th>id</th>
<th>date</th>
<th>city</th>
<th>category</th>
<th>age</th>
<th>price</th>
<th>gender</th>
<th>m-point</th>
<th>pay</th>
<th>group</th>
<th>sigh</th>
<th>catrgory_1</th>
<th>size </th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>1001</td>
<td>2013-01-02</td>
<td>beijing</td>
<td>100-A</td>
<td>23</td>
<td>1200</td>
<td>male</td>
<td>10</td>
<td>Y</td>
<td>low</td>
<td>NaN</td>
<td>100</td>
<td>A</td>
</tr>
<tr>
<td>1</td>
<td>3</td>
<td>1004</td>
<td>2013-01-05</td>
<td>shenzhen</td>
<td>110-C</td>
<td>32</td>
<td>5433</td>
<td>female</td>
<td>40</td>
<td>Y</td>
<td>high</td>
<td>NaN</td>
<td>110</td>
<td>C</td>
</tr>
<tr>
<td>2</td>
<td>5</td>
<td>1006</td>
<td>2013-01-07</td>
<td>beijing</td>
<td>130-F</td>
<td>32</td>
<td>4432</td>
<td>female</td>
<td>40</td>
<td>Y</td>
<td>high</td>
<td>1.0</td>
<td>130</td>
<td>F</td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>1005</td>
<td>2013-01-06</td>
<td>shanghai</td>
<td>210-A</td>
<td>34</td>
<td>3299</td>
<td>male</td>
<td>40</td>
<td>N</td>
<td>high</td>
<td>NaN</td>
<td>210</td>
<td>A</td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>1002</td>
<td>2013-01-03</td>
<td>shanghai</td>
<td>100-B</td>
<td>44</td>
<td>3299</td>
<td>female</td>
<td>12</td>
<td>N</td>
<td>high</td>
<td>NaN</td>
<td>100</td>
<td>B</td>
</tr>
<tr>
<td>5</td>
<td>2</td>
<td>1003</td>
<td>2013-01-04</td>
<td>guangzhou</td>
<td>110-A</td>
<td>54</td>
<td>2133</td>
<td>male</td>
<td>20</td>
<td>Y</td>
<td>low</td>
<td>NaN</td>
<td>110</td>
<td>A</td>
</tr>
</tbody>
</table>
<ul>
<li>设置日期为索引 </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner=df_inner.set_index(&apos;date&apos;)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>id</th>
<th>city</th>
<th>category</th>
<th>age</th>
<th>price</th>
<th>gender</th>
<th>m-point</th>
<th>pay</th>
<th>group</th>
<th>sigh</th>
<th>catrgory_1</th>
<th>size </th>
</tr>
</thead>
<tbody>
<tr>
<td>date</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>2013-01-02</td>
<td>1001</td>
<td>beijing</td>
<td>100-A</td>
<td>23</td>
<td>1200</td>
<td>male</td>
<td>10</td>
<td>Y</td>
<td>low</td>
<td>NaN</td>
<td>100</td>
<td>A</td>
</tr>
<tr>
<td>2013-01-05</td>
<td>1004</td>
<td>shenzhen</td>
<td>110-C</td>
<td>32</td>
<td>5433</td>
<td>female</td>
<td>40</td>
<td>Y</td>
<td>high</td>
<td>NaN</td>
<td>110</td>
<td>C</td>
</tr>
<tr>
<td>2013-01-07</td>
<td>1006</td>
<td>beijing</td>
<td>130-F</td>
<td>32</td>
<td>4432</td>
<td>female</td>
<td>40</td>
<td>Y</td>
<td>high</td>
<td>1.0</td>
<td>130</td>
<td>F</td>
</tr>
<tr>
<td>2013-01-06</td>
<td>1005</td>
<td>shanghai</td>
<td>210-A</td>
<td>34</td>
<td>3299</td>
<td>male</td>
<td>40</td>
<td>N</td>
<td>high</td>
<td>NaN</td>
<td>210</td>
<td>A</td>
</tr>
<tr>
<td>2013-01-03</td>
<td>1002</td>
<td>shanghai</td>
<td>100-B</td>
<td>44</td>
<td>3299</td>
<td>female</td>
<td>12</td>
<td>N</td>
<td>high</td>
<td>NaN</td>
<td>100</td>
<td>B</td>
</tr>
<tr>
<td>2013-01-04</td>
<td>1003</td>
<td>guangzhou</td>
<td>110-A</td>
<td>54</td>
<td>2133</td>
<td>male</td>
<td>20</td>
<td>Y</td>
<td>low</td>
<td>NaN</td>
<td>110</td>
<td>A</td>
</tr>
</tbody>
</table>
<p>使用冒号限定提取数据的范围，冒号前面为空表示从0开始。提取所有2013年1月4日以前的数据。</p>
<ul>
<li>提取4日之前的所有数据</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner[:&apos;2013-01-04&apos;]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>id</th>
<th>city</th>
<th>category</th>
<th>age</th>
<th>price</th>
<th>gender</th>
<th>m-point</th>
<th>pay</th>
<th>group</th>
<th>sigh</th>
<th>catrgory_1</th>
<th>size </th>
</tr>
</thead>
<tbody>
<tr>
<td>date</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>2013-01-02</td>
<td>1001</td>
<td>beijing</td>
<td>100-A</td>
<td>23</td>
<td>1200</td>
<td>male</td>
<td>10</td>
<td>Y</td>
<td>low</td>
<td>NaN</td>
<td>100</td>
<td>A</td>
</tr>
<tr>
<td>2013-01-03</td>
<td>1002</td>
<td>shanghai</td>
<td>100-B</td>
<td>44</td>
<td>3299</td>
<td>female</td>
<td>12</td>
<td>N</td>
<td>high</td>
<td>NaN</td>
<td>100</td>
<td>B</td>
</tr>
<tr>
<td>2013-01-04</td>
<td>1003</td>
<td>guangzhou</td>
<td>110-A</td>
<td>54</td>
<td>2133</td>
<td>male</td>
<td>20</td>
<td>Y</td>
<td>low</td>
<td>NaN</td>
<td>110</td>
<td>A</td>
</tr>
</tbody>
</table>
<h3 id="按位置提取（iloc）"><a href="#按位置提取（iloc）" class="headerlink" title="按位置提取（iloc）"></a>按位置提取（iloc）</h3><p>使用iloc函数按位置对数据表中的数据进行提取，这里冒号前后的数字不再是索引的标签名称，而是数据所在的位置，从0开始。</p>
<ul>
<li>使用iloc按位置区域提取数据</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.iloc[:3,:2]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>id</th>
<th>city </th>
</tr>
</thead>
<tbody>
<tr>
<td>date</td>
<td></td>
<td></td>
</tr>
<tr>
<td>2013-01-02</td>
<td>1001</td>
<td>beijing </td>
</tr>
<tr>
<td>2013-01-05</td>
<td>1004</td>
<td>shenzhen </td>
</tr>
<tr>
<td>2013-01-07</td>
<td>1006</td>
<td>beijing </td>
</tr>
</tbody>
</table>
<p>iloc函数除了可以按区域提取数据，还可以按位置逐条提取，前面方括号中的0,2,5表示数据所在行的位置，后面方括号中的数表示所在列的位置。</p>
<ul>
<li>使用iloc按位置单独提取数据</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.iloc[[0,2,5],[4,5]]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>price</th>
<th>gender </th>
</tr>
</thead>
<tbody>
<tr>
<td>date</td>
<td></td>
<td></td>
</tr>
<tr>
<td>2013-01-02</td>
<td>1200</td>
<td>male </td>
</tr>
<tr>
<td>2013-01-07</td>
<td>4432</td>
<td>female </td>
</tr>
<tr>
<td>2013-01-04</td>
<td>2133</td>
<td>male </td>
</tr>
</tbody>
</table>
<h3 id="按标签和位置提取（ix）"><a href="#按标签和位置提取（ix）" class="headerlink" title="按标签和位置提取（ix）"></a>按标签和位置提取（ix）</h3><p>ix是loc和iloc的混合，既能按索引标签提取，也能按位置进行数据提取。下面代码中行的位置按索引日期设置，列按位置设置。</p>
<ul>
<li>使用ix按索引标签和位置混合提取数据</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_inner.ix[:&apos;2013-01-03&apos;,:4]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>id</th>
<th>city</th>
<th>category</th>
<th>age </th>
</tr>
</thead>
<tbody>
<tr>
<td>2013-01-02</td>
<td>1001</td>
<td>beijing</td>
<td>100-A</td>
<td>23 </td>
</tr>
<tr>
<td>2013-01-03</td>
<td>1002</td>
<td>shanghai</td>
<td>100-B</td>
<td>44 </td>
</tr>
</tbody>
</table>
<h3 id="按条件提取（区域和条件值）"><a href="#按条件提取（区域和条件值）" class="headerlink" title="按条件提取（区域和条件值）"></a>按条件提取（区域和条件值）</h3><h2 id="数据筛选"><a href="#数据筛选" class="headerlink" title="数据筛选"></a>数据筛选</h2><h3 id="按条件筛选（与，或，非）"><a href="#按条件筛选（与，或，非）" class="headerlink" title="按条件筛选（与，或，非）"></a>按条件筛选（与，或，非）</h3><h2 id="数据汇总"><a href="#数据汇总" class="headerlink" title="数据汇总"></a>数据汇总</h2><h3 id="分类汇总"><a href="#分类汇总" class="headerlink" title="分类汇总"></a>分类汇总</h3><h3 id="数据透视"><a href="#数据透视" class="headerlink" title="数据透视"></a>数据透视</h3><h2 id="数据统计"><a href="#数据统计" class="headerlink" title="数据统计"></a>数据统计</h2><h3 id="数据采样"><a href="#数据采样" class="headerlink" title="数据采样"></a>数据采样</h3><h3 id="描述统计"><a href="#描述统计" class="headerlink" title="描述统计"></a>描述统计</h3><h3 id="标准差"><a href="#标准差" class="headerlink" title="标准差"></a>标准差</h3><h3 id="协方差"><a href="#协方差" class="headerlink" title="协方差"></a>协方差</h3><h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df：任意的Pandas DataFrame对象</span><br><span class="line">s：任意的Pandas Series对象</span><br></pre></td></tr></table></figure>
<h3 id="导入数据"><a href="#导入数据" class="headerlink" title="导入数据"></a>导入数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(filename)：从CSV文件导入数据</span><br><span class="line">pd.read_table(filename)：从限定分隔符的文本文件导入数据</span><br><span class="line">pd.read_excel(&apos;file_name.xlsx&apos;,index_col=None,na_values=[&apos;NA&apos;])：从Excel文件导入数据</span><br><span class="line">pd.read_sql(query, connection_object)：从SQL表/库导入数据</span><br><span class="line">pd.read_json(json_string)：从JSON格式的字符串导入数据</span><br><span class="line">pd.read_html(url)：解析URL、字符串或者HTML文件，抽取其中的tables表格</span><br><span class="line">pd.read_clipboard()：从你的粘贴板获取内容，并传给read_table()</span><br><span class="line">pd.DataFrame(dict)：从字典对象导入数据，Key是列名，Value是数据</span><br></pre></td></tr></table></figure>
<h3 id="导出数据"><a href="#导出数据" class="headerlink" title="导出数据"></a>导出数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df.to_csv(filename)：导出数据到CSV文件</span><br><span class="line">df.to_excel(&apos;file_name.xlsx&apos;,sheet_name=&apos;Sheet1&apos;)：导出数据到Excel文件</span><br><span class="line">df.to_sql(table_name, connection_object)：导出数据到SQL表</span><br><span class="line">df.to_json(filename)：以Json格式导出数据到文本文件</span><br></pre></td></tr></table></figure>
<h3 id="创建测试对象"><a href="#创建测试对象" class="headerlink" title="创建测试对象"></a>创建测试对象</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pd.DataFrame(np.random.rand(20,5))：创建20行5列的随机数组成的DataFrame对象</span><br><span class="line">pd.Series(my_list)：从可迭代对象my_list创建一个Series对象</span><br><span class="line">df.index = pd.date_range(&apos;1900/1/01&apos;, periods=df.shape[0])：增加一个日期索引</span><br></pre></td></tr></table></figure>
<h3 id="查看、检查数据"><a href="#查看、检查数据" class="headerlink" title="查看、检查数据"></a>查看、检查数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df.head(n)：查看DataFrame对象的前n行</span><br><span class="line">df.tail(n)：查看DataFrame对象的最后n行</span><br><span class="line">df.shape()：查看行数和列数</span><br><span class="line">df.info()：查看索引、数据类型和内存信息</span><br><span class="line">df.describe()：查看数值型列的汇总统计</span><br><span class="line">s.value_counts(dropna=False)：查看Series对象的唯一值和计数</span><br><span class="line">df.apply(pd.Series.value_counts)：查看DataFrame对象中每一列的唯一值和计数</span><br></pre></td></tr></table></figure>
<h3 id="数据选取"><a href="#数据选取" class="headerlink" title="数据选取"></a>数据选取</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df[col]：根据列名，并以Series的形式返回列</span><br><span class="line">df[[col1, col2]]：以DataFrame形式返回多列</span><br><span class="line">s.iloc[0]：按位置选取数据</span><br><span class="line">s.loc[&apos;index_one&apos;]：按索引选取数据</span><br><span class="line">df.iloc[0,:]：返回第一行</span><br><span class="line">df.iloc[0,0]：返回第一列的第一个元素</span><br></pre></td></tr></table></figure>
<h3 id="数据清理"><a href="#数据清理" class="headerlink" title="数据清理"></a>数据清理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">df.columns = [&apos;a&apos;,&apos;b&apos;,&apos;c&apos;]：重命名列名</span><br><span class="line">pd.isnull()：检查DataFrame对象中的空值，并返回一个Boolean数组</span><br><span class="line">pd.notnull()：检查DataFrame对象中的非空值，并返回一个Boolean数组</span><br><span class="line">df.dropna()：删除所有包含空值的行</span><br><span class="line">df.dropna(axis=1)：删除所有包含空值的列</span><br><span class="line">df.dropna(axis=1,thresh=n)：删除所有小于n个非空值的行</span><br><span class="line">df.fillna(x)：用x替换DataFrame对象中所有的空值</span><br><span class="line">s.astype(float)：将Series中的数据类型更改为float类型</span><br><span class="line">s.replace(1,&apos;one&apos;)：用‘one’代替所有等于1的值</span><br><span class="line">s.replace([1,3],[&apos;one&apos;,&apos;three&apos;])：用&apos;one&apos;代替1，用&apos;three&apos;代替3</span><br><span class="line">df.rename(columns=lambda x: x + 1)：批量更改列名</span><br><span class="line">df.rename(columns=&#123;&apos;old_name&apos;: &apos;new_ name&apos;&#125;)：选择性更改列名</span><br><span class="line">df.set_index(&apos;column_one&apos;)：更改索引列</span><br><span class="line">df.rename(index=lambda x: x + 1)：批量重命名索引</span><br></pre></td></tr></table></figure>
<h3 id="数据处理：Filter、Sort和GroupBy"><a href="#数据处理：Filter、Sort和GroupBy" class="headerlink" title="数据处理：Filter、Sort和GroupBy"></a>数据处理：Filter、Sort和GroupBy</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df[df[col] &gt; 0.5]：选择col列的值大于0.5的行</span><br><span class="line">df.sort_values(col1)：按照列col1排序数据，默认升序排列</span><br><span class="line">df.sort_values(col2, ascending=False)：按照列col1降序排列数据</span><br><span class="line">df.sort_values([col1,col2], ascending=[True,False])：先按列col1升序排列，后按col2降序排列数据</span><br><span class="line">df.groupby(col)：返回一个按列col进行分组的Groupby对象</span><br><span class="line">df.groupby([col1,col2])：返回一个按多列进行分组的Groupby对象</span><br><span class="line">df.groupby(col1)[col2]：返回按列col1进行分组后，列col2的均值</span><br><span class="line">df.pivot_table(index=col1, values=[col2,col3], aggfunc=max)：创建一个按列col1进行分组，并计算col2和col3的最大值的数据透视表</span><br><span class="line">df.groupby(col1).agg(np.mean)：返回按列col1分组的所有列的均值</span><br><span class="line">data.apply(np.mean)：对DataFrame中的每一列应用函数np.mean</span><br><span class="line">data.apply(np.max,axis=1)：对DataFrame中的每一行应用函数np.max</span><br></pre></td></tr></table></figure>
<h3 id="数据合并"><a href="#数据合并" class="headerlink" title="数据合并"></a>数据合并</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df1.append(df2)：将df2中的行添加到df1的尾部</span><br><span class="line">df.concat([df1, df2],axis=1)：将df2中的列添加到df1的尾部</span><br><span class="line">df1.join(df2,on=col1,how=&apos;inner&apos;)：对df1的列和df2的列执行SQL形式的join</span><br></pre></td></tr></table></figure>
<h3 id="数据统计-1"><a href="#数据统计-1" class="headerlink" title="数据统计"></a>数据统计</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df.describe()：查看数据值列的汇总统计</span><br><span class="line">df.mean()：返回所有列的均值</span><br><span class="line">df.corr()：返回列与列之间的相关系数</span><br><span class="line">df.count()：返回每一列中的非空值的个数</span><br><span class="line">df.max()：返回每一列的最大值</span><br><span class="line">df.min()：返回每一列的最小值</span><br><span class="line">df.median()：返回每一列的中位数</span><br><span class="line">df.std()：返回每一列的标准差</span><br></pre></td></tr></table></figure>

      
      
        <div class="page-reward">
          <p><a href="javascript:void(0)" onclick="dashangToggle()" class="dashang">赏</a></p>
          <div class="hide_box"></div>
          <div class="shang_box">
            <a class="shang_close" href="javascript:void(0)" onclick="dashangToggle()">×</a>
            <div class="shang_tit">
              <p>纯属好玩</p>
            </div>
            <div class="shang_payimg">
              <img src="/img/alipayimg.jpg" alt="扫码支持" title="扫一扫" />
            </div>
              <div class="pay_explain">扫码打赏，你说多少就多少</div>
            <div class="shang_payselect">
              
                <div class="pay_item checked" data-id="alipay">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/alipay.png" alt="支付宝" /></span>
                </div>
              
              
                <div class="pay_item" data-id="wechat">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/weixin.png" alt="微信" /></span>
                </div>
              
            </div>
            <div class="shang_info">
              <p>打开<span id="shang_pay_txt">支付宝</span>扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
        </div>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
        <script type="text/javascript">
          $(".pay_item").click(function(){
            $(this).addClass('checked').siblings('.pay_item').removeClass('checked');
            var dataid=$(this).attr('data-id');
            $(".shang_payimg img").attr("src","/img/"+dataid+"img.jpg");
            $("#shang_pay_txt").text(dataid=="alipay"?"支付宝":"微信");
          });
          function dashangToggle(){
            
            $(".hide_box").fadeToggle();
            $(".shang_box").fadeToggle();
          }
        </script>
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2018/06/02/从Excel到Python——数据分析/">从Excel到Python——数据分析</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 Yue Dandy 的个人博客">Yue Dandy</a></p>
        <p><span>发布时间:</span>2018年06月02日 - 19时20分</p>
        <p><span>最后更新:</span>2018年07月02日 - 09时40分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2018/06/02/从Excel到Python——数据分析/" title="从Excel到Python——数据分析">http://github.com/lzxyzq/2018/06/02/从Excel到Python——数据分析/</a>
            <span class="copy-path" data-clipboard-text="原文: http://github.com/lzxyzq/2018/06/02/从Excel到Python——数据分析/　　作者: Yue Dandy" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a href="/2018/06/24/精益数据分析/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          精益数据分析
        
      </div>
    </a>
  
  
    <a href="/2018/05/31/Python文件读取/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Python文件读取</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#摘要"><span class="toc-number">1.</span> <span class="toc-text">摘要</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#生成数据表"><span class="toc-number">1.1.</span> <span class="toc-text">生成数据表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#导入数据表"><span class="toc-number">1.1.1.</span> <span class="toc-text">导入数据表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建数据表"><span class="toc-number">1.1.2.</span> <span class="toc-text">创建数据表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据表检查"><span class="toc-number">1.2.</span> <span class="toc-text">数据表检查</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据维度（行列）"><span class="toc-number">1.2.1.</span> <span class="toc-text">数据维度（行列）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据表信息"><span class="toc-number">1.2.2.</span> <span class="toc-text">数据表信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看数据格式"><span class="toc-number">1.2.3.</span> <span class="toc-text">查看数据格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看空值"><span class="toc-number">1.2.4.</span> <span class="toc-text">查看空值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看唯一值"><span class="toc-number">1.2.5.</span> <span class="toc-text">查看唯一值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看数据表数值"><span class="toc-number">1.2.6.</span> <span class="toc-text">查看数据表数值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看列名称"><span class="toc-number">1.2.7.</span> <span class="toc-text">查看列名称</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看前3行数据"><span class="toc-number">1.2.8.</span> <span class="toc-text">查看前3行数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看后10行数据"><span class="toc-number">1.2.9.</span> <span class="toc-text">查看后10行数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据清洗"><span class="toc-number">1.3.</span> <span class="toc-text">数据清洗</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#处理空值-删除或填充"><span class="toc-number">1.3.1.</span> <span class="toc-text">处理空值(删除或填充)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#清理表格"><span class="toc-number">1.3.2.</span> <span class="toc-text">清理表格</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#大小写转换"><span class="toc-number">1.3.3.</span> <span class="toc-text">大小写转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更改数据格式"><span class="toc-number">1.3.4.</span> <span class="toc-text">更改数据格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更改列名字"><span class="toc-number">1.3.5.</span> <span class="toc-text">更改列名字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除重复值"><span class="toc-number">1.3.6.</span> <span class="toc-text">删除重复值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数值修改和替换"><span class="toc-number">1.3.7.</span> <span class="toc-text">数值修改和替换</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据预处理"><span class="toc-number">1.4.</span> <span class="toc-text">数据预处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据表合并"><span class="toc-number">1.4.1.</span> <span class="toc-text">数据表合并</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置索引列"><span class="toc-number">1.4.2.</span> <span class="toc-text">设置索引列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#排序（按索引，按数值）"><span class="toc-number">1.4.3.</span> <span class="toc-text">排序（按索引，按数值）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据分组"><span class="toc-number">1.4.4.</span> <span class="toc-text">数据分组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据分列"><span class="toc-number">1.4.5.</span> <span class="toc-text">数据分列</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据提取"><span class="toc-number">1.5.</span> <span class="toc-text">数据提取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#按标签提取（loc）"><span class="toc-number">1.5.1.</span> <span class="toc-text">按标签提取（loc）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#按位置提取（iloc）"><span class="toc-number">1.5.2.</span> <span class="toc-text">按位置提取（iloc）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#按标签和位置提取（ix）"><span class="toc-number">1.5.3.</span> <span class="toc-text">按标签和位置提取（ix）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#按条件提取（区域和条件值）"><span class="toc-number">1.5.4.</span> <span class="toc-text">按条件提取（区域和条件值）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据筛选"><span class="toc-number">1.6.</span> <span class="toc-text">数据筛选</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#按条件筛选（与，或，非）"><span class="toc-number">1.6.1.</span> <span class="toc-text">按条件筛选（与，或，非）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据汇总"><span class="toc-number">1.7.</span> <span class="toc-text">数据汇总</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#分类汇总"><span class="toc-number">1.7.1.</span> <span class="toc-text">分类汇总</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据透视"><span class="toc-number">1.7.2.</span> <span class="toc-text">数据透视</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据统计"><span class="toc-number">1.8.</span> <span class="toc-text">数据统计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据采样"><span class="toc-number">1.8.1.</span> <span class="toc-text">数据采样</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#描述统计"><span class="toc-number">1.8.2.</span> <span class="toc-text">描述统计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#标准差"><span class="toc-number">1.8.3.</span> <span class="toc-text">标准差</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#协方差"><span class="toc-number">1.8.4.</span> <span class="toc-text">协方差</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#附录"><span class="toc-number">1.9.</span> <span class="toc-text">附录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#导入数据"><span class="toc-number">1.9.1.</span> <span class="toc-text">导入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导出数据"><span class="toc-number">1.9.2.</span> <span class="toc-text">导出数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建测试对象"><span class="toc-number">1.9.3.</span> <span class="toc-text">创建测试对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看、检查数据"><span class="toc-number">1.9.4.</span> <span class="toc-text">查看、检查数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据选取"><span class="toc-number">1.9.5.</span> <span class="toc-text">数据选取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据清理"><span class="toc-number">1.9.6.</span> <span class="toc-text">数据清理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据处理：Filter、Sort和GroupBy"><span class="toc-number">1.9.7.</span> <span class="toc-text">数据处理：Filter、Sort和GroupBy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据合并"><span class="toc-number">1.9.8.</span> <span class="toc-text">数据合并</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据统计-1"><span class="toc-number">1.9.9.</span> <span class="toc-text">数据统计</span></a></li></ol></li></ol></li></ol>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
      <div class="duoshuo" id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="2018/06/02/从Excel到Python——数据分析/" data-title="从Excel到Python——数据分析" data-url="http://github.com/lzxyzq/2018/06/02/从Excel到Python——数据分析/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"lzxyzq"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = '/js/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
    <!-- 多说公共JS代码 end -->
</div>

    



    <div class="scroll" id="post-nav-button">
        
            <a href="/2018/06/24/精益数据分析/" title="上一篇: 精益数据分析">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2018/05/31/Python文件读取/" title="下一篇: Python文件读取">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/06/13/An-Introduction-of-Statistical-Learning/">An Introduction of Statistical Learning</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/25/Principle_of_Operating_System/">操作系统原理</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/03/book_python_practice_of_data_analysis_and_mining/">python数据分析与挖掘实战——张良均</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/29/线性回归/">Logistic Regression, LDA QDA and KNN</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/25/用数据讲故事/">用数据讲故事</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/24/计算机网络/">计算机网络</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/17/利用python进行数据分析/">利用python进行数据分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/24/精益数据分析/">精益数据分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/02/从Excel到Python——数据分析/">从Excel到Python——数据分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/31/Python文件读取/">Python文件读取</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/31/Python函数使用/">Python函数使用</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>


   <div id="lv-container" data-id="city" data-uid="MTAyMC80MTczOS8xODI4NQ==">
<script type="text/javascript">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];

       if (typeof LivereTower === 'function') { return; }

       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;

       e.parentNode.insertBefore(j, e);
   })(document, 'script');
</script>
<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
</div>
   </div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2020 Yue Dandy
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank"></a>Created
                <a href="https://github.com/lzxyzq/hexo-theme-spfk" target="_blank"></a> by lzxyzq
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >Mate到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


    <script type="text/javascript">
      window.onload = function(){
        document.getElementById("search").onclick = function(){
            console.log("search")
            search();
        }
      }
      function search(){
        (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
        (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
        e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
        })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

        _st('install','A1Pz-LKMXbrzcFg2FWi6','2.0.0');
      }
    </script>

  </div>
</body>
</html>